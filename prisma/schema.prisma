generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

model User {
  id            String            @id @default(cuid())
  name          String?
  email         String            @unique
  password      String
  image         String?
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  interviews    InterviewResult[]
  sopSubmissions SOPSubmission[]
}

model InterviewResult {
  id           String   @id @default(uuid())
  timestamp    DateTime @default(now())
  programName  String
  university   String
  overallScore Int
  toneScore    Int
  verdict      String
  feedbackJson String
  userId       String?
  user         User?    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model SOPSubmission {
  id          String   @id @default(uuid())
  createdAt   DateTime @default(now())
  programName String
  content     String
  score       Int
  analysis    String
  userId      String?
  user        User?    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model University {
  id                    String    @id @default(cuid())
  name                  String    @unique
  country               String
  qs_global_rank        Int?
  qs_europe_rank        Int?
  founding_year         Int?
  focus_areas           String
  research_strengths    String
  faculty_count         Int?
  international_percent Int?
  language_of_teaching  String
  website_url           String?
  university_type       String
  gdpr_compliance_note  String?
  eu_ai_act_aligned     Boolean?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  programs              Program[]

  @@index([qs_global_rank])
  @@index([qs_europe_rank])
  @@index([country])
}

model Program {
  id                   String     @id @default(cuid())
  name                 String
  level                String
  field_of_study       String
  university_id        String
  duration_months      Int?
  language             String
  intake_month         String?
  application_deadline DateTime?
  research_focused     Boolean    @default(true)
  thesis_required      Boolean    @default(true)
  internship_included  Boolean    @default(false)
  faculty_advisors     String
  createdAt            DateTime   @default(now())
  updatedAt            DateTime   @updatedAt
  university           University @relation(fields: [university_id], references: [id], onDelete: Cascade)

  @@unique([university_id, name, level])
  @@index([field_of_study])
  @@index([level])
}
